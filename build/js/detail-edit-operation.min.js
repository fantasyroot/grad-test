/*! detail-edit-operation 2015-01-26 */
$(function(){function a(a){switch($.trim(a)){case"prize01":return"2800￥";case"prize02":return"100￥";case"prize03":return"50￥";case"prize04":return"10￥"}}function b(){$("#gold").fadeOut(600),$("#chui").hide(),e(),clearTimeout(timerBoxOut),$("#box").fadeIn(2e3).addClass("animated bounceIn"),setTimeout(function(){$(".bg").fadeIn(200),$("#openBoxButton").fadeIn(400)},500)}function c(){$(".twindow").hide(),$("#openBoxButton").hide(),$(".bg").fadeOut(200),$("#box").hide(),$("#gold").show(),hitTimes=0,e(),d(h+1)}function d(a){for(var b=0;a>b;b++)$('<div class="wen"></div>').appendTo("body")}function e(){$(".wen").remove()}var f=$("#chui"),g=($("#treasure"),$("#gold")),h=1;hitTimes=0;var i="//gtms01.alicdn.com/tps/i1/TB1nPp9HXXXXXbqXFXXKdQq.VXX-128-0.ico",j="//gtms04.alicdn.com/tps/i4/TB1fvGfHXXXXXaZXXXXjznUFXXX-16-16.ico",k="//gtms04.alicdn.com/tps/i4/TB1DUd7HXXXXXa7XVXX_ZLfJXXX-83-63.png",l="//gtms04.alicdn.com/tps/i4/TB1DUd7HXXXXXa7XVXX_ZLfJXXX-83-63.png",m="";d(h+1),$.ajax({url:URL_CONFIG.winnerList,dataType:"jsonp",jsonp:"jsoncallback",success:function(b){var c="",d=$("#winnerList");$.each(b,function(d){c+="<li>"+b[d].name+"中了"+a(b[d].prize)+"红包</li>"}),d.html(c);var e=240;d.children().length>4&&setInterval(function(){parseFloat(d.css("left"))<(d.children().length-5)*-e&&d.css("left",e+"px"),d.animate({left:"-="+e+"px"},700,function(){})},3e3)}}),g.bind("mouseover",useChui=function(){$(this).css("cursor","url("+i+"),auto")}),g.bind("mousedown",function(a){$(this).unbind("mouseover",useChui).css("cursor","url("+j+"),auto"),setTimeout(function(){hitTimes++},1500),f.css({left:a.pageX,top:a.pageY}).show().css("transform","rotate(10deg)"),setTimeout(function(){f.css("transform","rotate(-20deg)"),setTimeout(function(){f.css("transform","rotate(0)"),g.addClass("shake shake-hard shake-constant"),$(".wen").addClass("shake shake-hard shake-constant"),hitTimes<h?(setTimeout(function(){$(".wen").eq(hitTimes).css("background","url("+k+")").css({left:a.pageX-40,top:a.pageY+65}).css({height:"63px",width:"83px"})},300),$.ajax({url:URL_CONFIG.getStatus,dataType:"jsonp",jsonp:"jsoncallback",success:function(a){switch(a){case"AvailableState":m="";break;case"UnLoginState":window.location.href=URL_CONFIG.loginUrl;break;case"UnableState":m="notStart";break;default:m="noQualification"}"notStart"==m?($(".bg").fadeIn(200),$("#loadInfo").children(".thead").text("活动还未开始"),$("#loadInfo").children(".tcontent").text("亲，活动还未开始，再等等哈"),setTimeout(function(){$("#loadInfo").fadeIn(200)},600)):"noQualification"==m&&($(".bg").fadeIn(200),$("#prizeResult").children(".thead").text("还没有抽奖机会哦"),$("#prizeResult").children(".tcontent").text("亲，赶紧同步吧"),setTimeout(function(){$("#prizeResult").fadeIn(200)},600))}}),setTimeout(function(){g.removeClass("shake shake-hard shake-constant").css("cursor","url("+i+"),auto").bind("mouseover",useChui),$(".wen").removeClass("shake shake-hard shake-constant"),f.hide()},500)):(setTimeout(function(){$(".wen").eq(hitTimes).css({background:"url("+l+"),no-repeat","background-size":"100%"}).css({left:a.pageX-72,top:a.pageY+65}).css({height:"98px",width:"133px"})},300),timerBoxOut=setTimeout(function(){g.removeClass("shake shake-hard shake-constant").css("cursor","url("+i+"),auto").bind("mouseover",useChui),$(".wen").removeClass("shake shake-hard shake-constant"),f.hide(),(hitTimes==h||hitTimes==h+1)&&setTimeout(function(){b()},1e3)},500))},200)},200)}),$("#openBoxButton").click(function(){$(this).hide(),$.ajax({url:URL_CONFIG.getLottery,dataType:"jsonp",jsonp:"jsoncallback",success:function(a){"0"==a.award&&(a.award="prize00");var b=Math.floor(Math.random()*prizeResultNotes[a.award].length);$("#prizeResult").children(".thead").text(prizeResultNotes[a.award][b].head),$("#prizeResult").children(".tcontent").text(prizeResultNotes[a.award][b].notes),$("#prizeResult").fadeIn(400).addClass("animated bounceIn")}})}),$(".sync").parent("button").click(function(){window.location.href=URL_CONFIG.syncUrl}),$(".okexit").parent("button").click(function(){c()}),$(".closeWindow").click(function(){c()}),$(".bg").click(function(){c()})}),window.onload=function(){setTimeout(function(){window.scrollTo(0,170)},100)},function(a,b){var c,d,e=new Date,f=a.document,g=!1,h=!1,i=!1,j=function(a){var b=0;b=window.pageYOffset?window.pageYOffset:document.documentElement.scrollTop;try{b+=a.getBoundingClientRect().top}catch(c){}finally{return b}},k=function(a,b){u.send(a,b)},l=0,m=function(){k("afs",d()-e)},n=function(a){return function(){this.removeEventListener?this.removeEventListener(a,arguments.callee,!1):this.detachEvent&&this.detachEvent("on"+a,arguments.callee),0===--l&&i&&setTimeout(function(){m()},100)}},o=n("error"),p=n("load"),q=function(a){var b=document.documentElement.clientHeight,c=j(a);return c>0&&b>c?(l++,a.addEventListener?(a.addEventListener("load",p,!1),a.addEventListener("error",o,!1)):a.attachEvent&&(a.attachEvent("onreadystatechange",function(){"complete"==a.readyState&&(a.detachEvent("onreadystatechange",arguments.callee),p.call(a))}),a.attachEvent("onerror",o)),!0):void 0},r=function(a){for(var b,c,d=f.getElementsByTagName("img"),e=+new Date,g=[],h=function(){this.removeEventListener&&this.removeEventListener("load",arguments.callee,!1),g.push({img:this,time:+new Date})},i=0,k=d.length;k>i;i++,c=!0)b=d[i],b.addEventListener&&!b.complete?("function"==typeof a&&(c=a(b)),c&&b.addEventListener("load",h,!1)):b.attachEvent&&"complete"!=b.readyState&&("function"==typeof a&&(c=a(b)),c&&b.attachEvent("onreadystatechange",function(a){return function(){try{var b=d[a]}catch(c){return}"complete"==b.readyState&&(b.detachEvent("onreadystatechange",arguments.callee),h.call(b))}}(i)));return function(){for(var a,b,c,f=document.documentElement.clientHeight,h=0,i=g.length;i>h;h++)a=g[h].img,b=g[h].time,c=j(a),c>0&&f>c&&(e=b>e?b:e);return d=null,g=null,e}},s=function(a){var b;g||a?a&&!i&&(d=r(q),--u.afsCounts||(i=!0),l||m()):(b=r(),c=function(){k("fs",b()-e)},g=!0)},t=function(){s(!0)},u={send:function(a,c){window.JSTracker&&JSTracker.send&&JSTracker.send({category:a,delay:c,spm:b}),console.log(a,c,b)},mark:function(a){var b={fs:s,afs:t};b[a]?b[a].call():this.send(a,new Date-e)},afsCounts:1},v=function(){v.ready||(s(),u.mark("domready"),v.ready=!0)},w=function(){h=!0,"function"==typeof c&&c(),u.mark("loaded")};if(a.__WPO)for(var x in u)a.__WPO[x]=u[x];else a.__WPO=u;var y=function(){try{document.documentElement.doScroll("left")}catch(a){return void setTimeout(y,1)}v()};if(f.addEventListener)f.addEventListener("DOMContentLoaded",function(){f.removeEventListener("DOMContentLoaded",arguments.callee),v()},!1),a.addEventListener("load",function(){f.removeEventListener("load",arguments.callee),w()},!1);else if(f.attachEvent){var z=!1;try{z=null==window.frameElement}catch(A){}document.documentElement.doScroll&&z&&y(),v.ready||f.attachEvent("onreadystatechange",function(){"complete"==f.readyState&&(f.detachEvent("onreadystatechange",arguments.callee),v())}),a.attachEvent("onload",function(){a.detachEvent("onload",arguments.callee),w()})}}(this,window.__spmStr);